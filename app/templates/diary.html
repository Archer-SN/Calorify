{% extends "layout.html" %}
<!--TODO: CHALLENGE-->
{% block body %}
    <div x-data="{ foodModalOpen : false, foodSummaryOpen: false }">
        <div id="challenge" class="border-solid border-2">
            <h1 class="text-lg font-bold">Challenge</h1>
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Difficulty</th>
                        <th>Expiration Date</th>
                    </tr>
                </thead>
                {% for challenge in challenges %}
                    <tr >
                        <td>{{ challenge.name }}</td>
                        <td>{{ challenge.difficulty }}</td>
                        <td>{{ challenge.expire_date }}</td>
                        <td hx-post="{% url 'challenge' %}" hx-target="closest tr" hx-swap="innerHTML" hx-vals='{"challengeId" : {{ challenge.id }} }' class="btn btn-outline btn-success">Complete Challenge</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
        <span id="food-modal" class="flex flex-col w-full border-solid border-2" x-show="foodModalOpen" x-trap="foodModalOpen" >
            <!--This is used for searching food in the database-->
            <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 hover:bg-red-500" @click="foodModalOpen = false">âœ•</button>              
            <h1 class="text-lg font-bold">Add Food to Diary</h1>
            <input type="search" name="search" placeholder="Search food here" class="input input-bordered w-full max-w-xs" 
                hx-get="{% url 'food' %}" 
                hx-trigger="keyup changed delay:500ms, search" 
                hx-target="#search-results" 
                hx-indicator=".htmx-indicator"
                hx-swap="innerHTML"
                />
                
                <table class="table">
                <thead>
                    <tr>
                  <th>Description</th>
                  <th>Source</th>
                </tr>
                </thead>
                <tbody id="search-results">
                    <span class="htmx-indicator loading loading-infinity loading-lg"></span> 
                </tbody>
            </table>
            <div id="food-summary-panel" x-show="foodSummaryOpen" class="flex w-full flex-row justify-center">
                
            </div>
        </span>
        <div id="log" class="border-solid border-2">
            <h1 class="text-lg font-bold">Daily Entries</h1>
            <div>
                <!--Contains buttons for adding entries-->
                <button class="btn btn-outline" hx-get="{% url 'food' %}" hx-target="#search-results" hx-swap="innerHTML" @click="foodModalOpen = true">Add Food</button>
                <button class="btn btn-outline" @click="foodSummaryOpen = true">Add Exercise</button>
            </div>
            <table class="table overflow-scroll">
                <tbody id="entries-container" >
                    
                    <!--Food and exercise entries are shown here-->
                    {% for food in daily_entry.food_intake %}
                        <tr class="hover" hx-post="{% url 'food' %}" hx-trigger="hover[delete]">
                            <td>{{ food.name }}</td>
                            <td>{{ food.weight }}</td>
                            <td>g</td>
                            <td>{{ food.energy }}</td>
                            <td>kcal</td>
                        </tr>
                    {% endfor %}
                    {% for exercise in daily_entry.exercises %}
                        <tr class="hover">
                            <td>{{ exercise.name }}</td>
                            <td>{{ exercise.duration }}</td>
                            <td>minutes</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div id="date">
        
        </div>
        <div id="summary" class="flex w-full justify-evenly border-solid border-2" >
            <!--Summarize Energy and Macronutrients-->
            <div>
                <h2 class="text-xl font-bold">Energy Summary</h2>
                <p class="font-bold">Consumed: {{ daily_entry.nutrients.general.energy }} kcal</p>
            </div>
            <div class="divider divider-horizontal"></div>
            <div>
                <h2 class="text-xl font-bold">Macronutrients Target</h2>
                <p class="font-bold">Energy: {{ daily_entry.nutrients.general.energy }} kcal</p>
                <p class="font-bold">Protein: {{ daily_entry.nutrients.protein.protein }} g</p>
                <p class="font-bold">Carbohydrates: {{ daily_entry.nutrients.carbohydrates.carbs }} g</p>
                <p class="font-bold">Fats: {{ daily_entry.nutrients.lipids.fat }} g</p>

            </div>
        </div>
        <div id="nutrients">
            <!--Summarize each nutrients-->
            <div id="general">
        
            </div>
            <div id="carbohydrates">
        
            </div>
            <div id="lipids">
        
            </div>
            <div id="general">
        
            </div>
            <div id="general">
        
            </div>
            <div id="vitamins">
        
            </div>
            <div id="minerals">
        
            </div>
        </div>
    </div>
{% endblock %}